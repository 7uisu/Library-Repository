{% extends 'pages/index.html' %}
{% load static %}

{% block content %}
<div class="container add-book-form">
    <h1>Add New Book</h1>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.non_field_errors }}
        
        <div class="add-book-section">
            <div class="add-book-cover-picture">
                <img src="{% static 'images/Person-Icon.jpg' %}" alt="Default Book Cover" class="add-book-cover-image">
                <br>
                <label for="id_book_cover_image">Choose Book Cover:</label>
                <div class="file-upload">
                    {{ form.book_cover_image }}
                </div>
                {% if form.book_cover_image.errors %}
                    {% for error in form.book_cover_image.errors %}
                        <span class="text-danger">{{ error }}</span><br>
                    {% endfor %}
                {% endif %}
                
                <label for="id_series_cover_image">Choose Series Cover:</label>
                <div class="file-upload">
                    {{ form.series_cover_image }}
                </div>
                {% if form.series_cover_image.errors %}
                    {% for error in form.series_cover_image.errors %}
                        <span class="text-danger">{{ error }}</span><br>
                    {% endfor %}
                {% endif %}
            </div>

            <div class="add-book-details">
                <div class="add-book-form-group">
                    <label for="id_title">Title:</label>
                    <input type="text" id="id_title" name="title" placeholder="Enter the title of the book...">
                    {% if form.title.errors %}
                        {% for error in form.title.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_series">Series:</label>
                    <input type="text" id="id_series" name="series" placeholder="Enter the series name (if applicable)...">
                    {% if form.series.errors %}
                        {% for error in form.series.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_publication_date">Publication Date:</label>
                    <input type="text" id="id_publication_date" name="publication_date" placeholder="YYYY-MM-DD">
                    {% if form.publication_date.errors %}
                        {% for error in form.publication_date.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% else %}
                        <small class="text-muted">Format: YYYY-MM-DD (e.g., 2022-01-01)</small>
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_volume">Volume:</label>
                    <input type="text" id="id_volume" name="volume" placeholder="Enter the volume number...">
                    {% if form.volume.errors %}
                        {% for error in form.volume.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_isbn">ISBN:</label>
                    <input type="text" id="id_isbn" name="isbn" placeholder="Enter the ISBN...">
                    {% if form.isbn.errors %}
                        {% for error in form.isbn.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_description">Description:</label>
                    <textarea id="id_description" name="description" placeholder="Enter a brief description or summary of the book..."></textarea>
                    {% if form.description.errors %}
                        {% for error in form.description.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_language">Language:</label>
                    <select id="id_language" name="language">
                        <option value="" selected disabled>Choose a language...</option>
                        {% for language in form.fields.language.choices %}
                        <option value="{{ language.0 }}">{{ language.1 }}</option>
                        {% endfor %}
                    </select>
                    {% if form.language.errors %}
                        {% for error in form.language.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_authors">Authors:</label>
                    <div class="select-instructions">
                        * Hold Ctrl to select multiple Authors
                    </div>
                    <select id="id_authors" name="authors" multiple>
                        {% for author in form.fields.authors.queryset.all %}
                        <option value="{{ author.pk }}">{{ author.first_name }} {{ author.last_name }}</option>
                        {% endfor %}
                    </select>
                    {% if form.authors.errors %}
                        {% for error in form.authors.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_genres">Genres:</label>
                    <div class="select-instructions">
                        * Hold Ctrl to select multiple Genres
                    </div>
                    <select id="id_genres" name="genres" multiple>
                        {% for genre in form.fields.genres.queryset.all %}
                        <option value="{{ genre.pk }}">{{ genre.name }}</option>
                        {% endfor %}
                    </select>
                    {% if form.genres.errors %}
                        {% for error in form.genres.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_collaborating_publishers">Collaborating Publishers:</label>
                    <div class="select-instructions">
                        * Hold Ctrl to select multiple Publishers
                    </div>
                    <select id="id_collaborating_publishers" name="collaborating_publishers" multiple>
                        {% for publisher in form.fields.collaborating_publishers.queryset.all %}
                        <option value="{{ publisher.pk }}">{{ publisher.name }}</option>
                        {% endfor %}
                    </select>
                    {% if form.collaborating_publishers.errors %}
                        {% for error in form.collaborating_publishers.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_ebook_file">Ebook File:</label>
                    <input type="file" id="id_ebook_file" name="ebook_file">
                    {% if form.ebook_file.errors %}
                        {% for error in form.ebook_file.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_audiobook_file">Audiobook File:</label>
                    <input type="file" id="id_audiobook_file" name="audiobook_file">
                    {% if form.audiobook_file.errors %}
                        {% for error in form.audiobook_file.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <label for="id_audiobook_duration">Audiobook Duration (HH:MM:SS):</label>
                    <input type="text" id="id_audiobook_duration" name="audiobook_duration" placeholder="Enter audiobook duration...">
                    {% if form.audiobook_duration.errors %}
                        {% for error in form.audiobook_duration.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="add-book-form-group">
                    <button type="submit" class="btn btn-primary">Add Book</button>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}
